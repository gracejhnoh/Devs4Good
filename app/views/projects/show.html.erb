<h2><%= @project.title %></h2>
<div>Project Summary: <%= @project.summary %></div>
<div>Project Details: <%= raw(@project.description) %></div>

<div>
  Requested by: <%= link_to(@project.organization.org_name, organization_path(@project.organization.id)) %><br/>
  <% if logged_in? && (current_user.user_type == 'dev' || @project.organization.id == current_user.id ) && @project.contact_email != '' %>
  Project contact e-mail: <%= mail_to(@project.contact_email) %>
  <% end %>
</div>
<div>Time frame: <%= @project.time_frame %></div>

<% if logged_in? && current_user.user_type == 'org' && @project.organization.id == current_user.id %>
  <%= link_to('Edit', edit_organization_project_path(@project.organization, @project)) %>
  <%= link_to('Delete', organization_project_path, method: :delete, data: { confirm: 'Are you sure?' }) %>
<% end %>

<% if logged_in? && current_user.user_type == 'dev' %>
  <%= link_to('Add Proposal', new_project_proposal_path(@project)) %>
<% end %>

<% if @project.selected_proposal %>
  <div>
    Selected developer:
    <%= link_to(@project.selected_proposal.developer.full_name, developer_path(@project.selected_proposal.developer)) %>
  </div>
<% end %>

<% if logged_in? && current_user.user_type == 'org' && @project.organization.id == current_user.id %>
  <h3>Proposals: </h3>
  <div class='dev-proposals-container'>
    <% if !@project.selected_proposal %>
      <% @project.proposals.each do |proposal| %>
        <div class='proposal-not-selected-box interor-links inline-block'>
          <div class='proposal-title'>
            <%= link_to(proposal.developer.full_name, project_proposal_path(proposal.project, proposal))  %>
          </div>
          <% if !@project.selected_proposal %>
          <div class='status'>
            <%= form_for proposal, url: project_proposal_path(@project.id, proposal.id) do |f| %>
              <%= f.hidden_field :selected, :value => 'true' %>
              <%= f.submit "Select", class: 'select-proposal-button' %>
            <% end %>
          </div>
          <% end %>
        </div>
      <% end %>
    <% else %>
      <% @project.proposals.each do |proposal| %>
        <% if proposal.selected == true %>
          <div class='focus-box interor-links inline-block'>
            <div class='proposal-title'>
            <%= link_to proposal.developer.full_name, project_proposal_path(proposal.project, proposal) %>
            </div>
            <div class='status'>
              Selected!
            </div>
          </div>
        <% else %>
          <div class='proposal-not-selected-box interor-non-selected-links inline-block'>
          <div class='proposal-title'>
            <%= link_to proposal.developer.full_name, project_proposal_path(proposal.project, proposal) %>
          </div>
            <div class='status'>
              Not selected
            </div>
          </div>
        <% end %>
      <% end %>
    <% end %>

  </div>
<% end %>

<% if logged_in? && current_user.user_type == 'dev' %>
<h3>My Proposals: </h3>
<div class='cards'>
  <ul>
    <% i = 1 %>
      <% @project.developer_proposal(current_user).each do |proposal| %>
      <div class='card'>
        <div class='card-copy'>
          <li><%= link_to(raw("Proposal #{i}"), project_proposal_path(@project.id, proposal.id)) %></li>
        </div>
      </div>
      <% i += 1 %>
    <% end %>
  </ul>
</div>
<% end %>
